# Docker "too many open files" æ°¸ä¹…ä¿®å¤ - è¯¦ç»†æ­¥éª¤

## ğŸ“‹ æ“ä½œæ­¥éª¤ï¼ˆå…±3æ­¥ï¼‰

---

## âœ… æ­¥éª¤1: æ‰“å¼€ç»ˆç«¯

1. æŒ‰ `Command + ç©ºæ ¼é”®` æ‰“å¼€ Spotlight æœç´¢
2. è¾“å…¥ `ç»ˆç«¯` æˆ– `Terminal`
3. æŒ‰ Enter é”®æ‰“å¼€ç»ˆç«¯

---

## âœ… æ­¥éª¤2: æ‰§è¡Œä¿®å¤å‘½ä»¤ï¼ˆéœ€è¦è¾“å…¥å¯†ç ï¼‰

**å¤åˆ¶ä»¥ä¸‹å…¨éƒ¨å†…å®¹ï¼Œç²˜è´´åˆ°ç»ˆç«¯ä¸­ï¼Œç„¶åæŒ‰ Enterï¼š**

```bash
sudo tee /Library/LaunchDaemons/limit.maxfiles.plist > /dev/null <<'EOF'
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
  <dict>
    <key>Label</key>
    <string>limit.maxfiles</string>
    <key>ProgramArguments</key>
    <array>
      <string>launchctl</string>
      <string>limit</string>
      <string>maxfiles</string>
      <string>65536</string>
      <string>200000</string>
    </array>
    <key>RunAtLoad</key>
    <true/>
    <key>ServiceIPC</key>
    <false/>
  </dict>
</plist>
EOF
sudo launchctl load -w /Library/LaunchDaemons/limit.maxfiles.plist 2>/dev/null || sudo launchctl bootstrap system /Library/LaunchDaemons/limit.maxfiles.plist
sudo launchctl limit maxfiles 65536 200000
```

**æ‰§è¡Œåä¼šè¦æ±‚è¾“å…¥å¯†ç ï¼š**
- è¾“å…¥ä½ çš„ **Mac ç™»å½•å¯†ç **ï¼ˆè¾“å…¥æ—¶ä¸ä¼šæ˜¾ç¤ºå­—ç¬¦ï¼Œè¿™æ˜¯æ­£å¸¸çš„ï¼‰
- è¾“å…¥å®ŒæˆåæŒ‰ Enter

**ç­‰å¾…å‘½ä»¤æ‰§è¡Œå®Œæˆ**ï¼ˆé€šå¸¸å‡ ç§’é’Ÿï¼‰

---

## âœ… æ­¥éª¤3: é‡å¯ Docker Desktop

**åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š**

```bash
osascript -e 'quit app "Docker"'
```

ç­‰å¾… 3-5 ç§’ï¼Œç„¶åæ‰§è¡Œï¼š

```bash
open -a Docker
```

**ç­‰å¾… Docker Desktop å®Œå…¨å¯åŠ¨**ï¼ˆèœå•æ ä¼šå‡ºç° Docker å›¾æ ‡ï¼Œçº¦ 30-60 ç§’ï¼‰

---

## âœ… æ­¥éª¤4: éªŒè¯ä¿®å¤æ˜¯å¦æˆåŠŸ

**åœ¨ç»ˆç«¯ä¸­ä¾æ¬¡æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ£€æŸ¥ï¼š**

### æ£€æŸ¥1: æŸ¥çœ‹ç³»ç»Ÿé™åˆ¶

```bash
launchctl limit maxfiles
```

**åº”è¯¥æ˜¾ç¤ºï¼š**
```
maxfiles    65536           200000
```

### æ£€æŸ¥2: æŸ¥çœ‹å½“å‰é™åˆ¶

```bash
ulimit -n
```

**åº”è¯¥æ˜¾ç¤ºï¼š**
```
65536
```

### æ£€æŸ¥3: éªŒè¯ Docker æ˜¯å¦æ­£å¸¸

```bash
docker info
```

**å¦‚æœä¸å†å‡ºç° "too many open files" é”™è¯¯ï¼Œè¯´æ˜ä¿®å¤æˆåŠŸï¼** âœ…

---

## ğŸ‰ å®Œæˆï¼

ä¿®å¤å®Œæˆåï¼ŒDocker åº”è¯¥ä¸å†å‡ºç° "too many open files" é”™è¯¯ã€‚

---

## â“ å¦‚æœé‡åˆ°é—®é¢˜

### é—®é¢˜1: å¯†ç è¾“å…¥é”™è¯¯

**è§£å†³**: é‡æ–°æ‰§è¡Œæ­¥éª¤2ï¼Œç¡®ä¿å¯†ç æ­£ç¡®

### é—®é¢˜2: å‘½ä»¤æ‰§è¡Œå¤±è´¥

**è§£å†³**: ç¡®ä¿ä½ å¤åˆ¶äº†å®Œæ•´çš„å‘½ä»¤ï¼ˆåŒ…æ‹¬æ‰€æœ‰è¡Œï¼‰

### é—®é¢˜3: Docker ä»ç„¶æŠ¥é”™

**è§£å†³**: 
1. å®Œå…¨é‡å¯ Macï¼ˆç³»ç»Ÿçº§é…ç½®éœ€è¦é‡å¯æ‰èƒ½å®Œå…¨ç”Ÿæ•ˆï¼‰
2. æˆ–è€…ç­‰å¾…å‡ åˆ†é’Ÿåé‡è¯•

### é—®é¢˜4: ä¸çŸ¥é“å¦‚ä½•å¤åˆ¶å‘½ä»¤

**è§£å†³**: 
- åœ¨ç»ˆç«¯ä¸­ï¼Œé€‰ä¸­å‘½ä»¤æ–‡æœ¬
- æŒ‰ `Command + C` å¤åˆ¶
- åœ¨ç»ˆç«¯ä¸­æŒ‰ `Command + V` ç²˜è´´

---

## ğŸ“ å¿«é€Ÿå‚è€ƒ

**ä¸€é”®æ‰§è¡Œæ‰€æœ‰å‘½ä»¤ï¼ˆå¤åˆ¶ç²˜è´´åˆ°ç»ˆç«¯ï¼‰ï¼š**

```bash
sudo tee /Library/LaunchDaemons/limit.maxfiles.plist > /dev/null <<'EOF'
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
  <dict>
    <key>Label</key>
    <string>limit.maxfiles</string>
    <key>ProgramArguments</key>
    <array>
      <string>launchctl</string>
      <string>limit</string>
      <string>maxfiles</string>
      <string>65536</string>
      <string>200000</string>
    </array>
    <key>RunAtLoad</key>
    <true/>
    <key>ServiceIPC</key>
    <false/>
  </dict>
</plist>
EOF
sudo launchctl load -w /Library/LaunchDaemons/limit.maxfiles.plist 2>/dev/null || sudo launchctl bootstrap system /Library/LaunchDaemons/limit.maxfiles.plist
sudo launchctl limit maxfiles 65536 200000
osascript -e 'quit app "Docker"' && sleep 3 && open -a Docker
```

---

## âœ… æ£€æŸ¥æ¸…å•

å®Œæˆä»¥ä¸‹æ‰€æœ‰æ­¥éª¤åï¼Œä¿®å¤å°±å®Œæˆäº†ï¼š

- [ ] æ‰“å¼€äº†ç»ˆç«¯
- [ ] æ‰§è¡Œäº†ä¿®å¤å‘½ä»¤ï¼ˆè¾“å…¥äº†å¯†ç ï¼‰
- [ ] é‡å¯äº† Docker Desktop
- [ ] éªŒè¯äº† `launchctl limit maxfiles` æ˜¾ç¤º `65536 200000`
- [ ] éªŒè¯äº† `ulimit -n` æ˜¾ç¤º `65536`
- [ ] éªŒè¯äº† `docker info` ä¸å†æŠ¥é”™

---

**éœ€è¦å¸®åŠ©ï¼ŸæŸ¥çœ‹ `EXECUTE_NOW.md` æˆ– `PERMANENT_FIX_STEPS.md` è·å–æ›´å¤šä¿¡æ¯ã€‚**
